<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>ì¶œë°œ ë¡œì¼€ì´ì…˜ QR</title>
<script src="https://unpkg.com/html5-qrcode"></script>
<style>
  body {
    font-family: -apple-system, BlinkMacSystemFont, sans-serif;
    padding: 16px;
  }
  button {
    width: 100%;
    padding: 14px;
    font-size: 16px;
    border-radius: 8px;
    border: none;
    background: #0a7cff;
    color: #fff;
    font-weight: 600;
    margin-bottom: 12px;
  }
  #reader {
    width: 300px;
    height: 300px;
    margin: 0 auto;
  }
</style>
</head>

<body>

<h3>ğŸ“ ì¶œë°œ ë¡œì¼€ì´ì…˜ QR ìŠ¤ìº”</h3>

<!-- âœ… ì‚¬ìš©ì í´ë¦­ í•„ìˆ˜ -->
<button id="startScan" type="button">ğŸ“· QR ìŠ¤ìº” ì‹œì‘</button>

<div id="reader"></div>

<script>
const qr = new Html5Qrcode("reader");

document.getElementById("startScan").addEventListener("click", () => {
  qr.start(
    { facingMode: "environment" },
    { fps: 10, qrbox: 250 },
    (decodedText) => {
      qr.stop();

      let location = decodedText.trim();

      if (location.includes(":")) location = location.split(":").pop();
      if (location.includes("|")) location = location.split("|").pop();
      if (location.startsWith("http")) location = location.split("/").pop();

      location = location.trim();
      if (!location) {
        alert("ë¡œì¼€ì´ì…˜ QR ì¸ì‹ ì‹¤íŒ¨");
        return;
      }

      // ì¶œë°œ ë¡œì¼€ì´ì…˜ â†’ ì¬ê³  ì„ íƒ í™”ë©´ìœ¼ë¡œ ì´ë™
      window.location.href =
        "/m/qr/move/select?from_location=" + encodeURIComponent(location);
    }
  ).catch(err => {
    alert("ì¹´ë©”ë¼ ì ‘ê·¼ ì‹¤íŒ¨ (ê¶Œí•œ/HTTPS í™•ì¸)");
    console.error(err);
  });
});
</script>

</body>
</html>

