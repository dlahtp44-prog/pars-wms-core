{% extends "base.html" %}
{% block content %}
<div class="card">
  <h2>ì´ë ¥ ì¡°íšŒ</h2>
  <div style="display:flex; gap:8px; flex-wrap:wrap; margin-bottom:10px;">
    <a class="btn" href="/print/ì´ë ¥.pdf" target="_blank">ğŸ–¨ï¸ ì´ë ¥ ì¶œë ¥(PDF)</a>
    <a class="btn" href="/print/ì´ë ¥.pdf?êµ¬ë¶„=ì¶œê³ " target="_blank">ì¶œê³ ë§Œ</a>
    <a class="btn" href="/print/ì´ë ¥.pdf?êµ¬ë¶„=ì´ë™" target="_blank">ì´ë™ë§Œ</a>
  </div>
  <div id="hist"></div>
</div>

<script>
async function loadHist(){
  const res = await fetch('/api/ì´ë ¥?limit=200');
  const data = await res.json();
  let html = `<p class="small">ìµœê·¼ ${data.count}ê±´</p>`;
  html += `<table class="table"><thead><tr>
    <th>êµ¬ë¶„</th><th>ì°½ê³ </th><th>í’ˆë²ˆ</th><th>í’ˆëª…</th><th>LOT</th><th>ê·œê²©</th><th>ì¶œë°œ</th><th>ë„ì°©</th><th>ìˆ˜ëŸ‰</th><th>ì‹œê°„</th>
  </tr></thead><tbody>`;
  for(const it of data.items){
    html += `<tr><td>${it['êµ¬ë¶„']}</td><td>${it['ì°½ê³ ']}</td><td>${it['í’ˆë²ˆ']}</td><td>${it['í’ˆëª…']}</td><td>${it['LOT']}</td><td>${it['ê·œê²©']}</td>
      <td>${it['ì¶œë°œë¡œì¼€ì´ì…˜']||''}</td><td>${it['ë„ì°©ë¡œì¼€ì´ì…˜']||''}</td><td>${it['ìˆ˜ëŸ‰']}</td><td>${it['created_at']}</td></tr>`;
  }
  html += `</tbody></table>`;
  document.getElementById('hist').innerHTML = html;
}
loadHist();
</script>
{% endblock %}
