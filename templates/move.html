{% extends "base.html" %}
{% block body %}
<h1>이동등록</h1>

<div class="badge"><a href="/" style="text-decoration:none;color:var(--primary);font-weight:600;">← 홈</a></div>

<div class="card" style="padding:16px;">
  <form id="f">
    <div class="grid">
      <label class="form-row"><span>출발</span><input class="input" name="src_location" placeholder="출발 로케이션" required></label>
      <label class="form-row"><span>도착</span><input class="input" name="dst_location" placeholder="도착 로케이션" required></label>
      <label class="form-row"><span>품번</span><input class="input" name="item_code" required></label>
      <label class="form-row"><span>품명</span><input class="input" name="item_name" required></label>
      <label class="form-row"><span>LOT</span><input class="input" name="lot" required></label>
      <label class="form-row"><span>규격</span><input class="input" name="spec" required></label>
      <label class="form-row"><span>브랜드</span><input class="input" name="brand"></label>
      <label class="form-row"><span>수량</span><input class="input" name="qty" type="number" min="1" required></label>
      <label class="form-row"><span>비고</span><input class="input" name="note"></label>
      <button class="btn" type="submit">이동 처리</button>
      <div id="msg" class="badge"></div>
    </div>
  </form>

<div class="hr"></div>
<h3 style="margin:10px 0 6px 0;">엑셀 업로드</h3>
<div class="small" style="color:#667085;margin-bottom:8px;">
  컬럼 예시: 출발로케이션, 도착로케이션, 품번, 품명, LOT, 규격, 수량 (옵션: 브랜드, 비고)
</div>
<form action="/page/move/excel" method="post" enctype="multipart/form-data">
  <input class="input" type="file" name="file" accept=".xlsx" required>
  <button class="btn" type="submit" style="margin-top:10px;">엑셀 업로드 실행</button>
</form>


</div>
{% endblock %}
{% block script %}
<script>
document.getElementById('f').addEventListener('submit', async (e)=>{
  e.preventDefault();
  const fd = new FormData(e.target);
  const r = await fetch('/api/move', {method:'POST', body: fd});
  const t = await r.json().catch(()=>({}));
  const msg = document.getElementById('msg');
  if(r.ok){ msg.textContent='저장 완료'; e.target.reset(); }
  else{ msg.textContent='오류: ' + (t.detail || r.status); }
});
</script>
{% endblock %}
