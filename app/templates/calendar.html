
{% extends "_layout.html" %}
{% block body %}
<div class="header">달력</div>
<div class="card">
  <div class="top-actions">
    <a href="/">← 홈</a>
  </div>

  <form class="form" method="get" action="/page/calendar">
    <label>날짜 선택</label>
    <input type="date" name="date" value="{{ date }}" />
    <button type="submit">해당 날짜 보기</button>
  </form>

  <hr style="border:none;border-top:1px solid #e6e9ee;margin:14px 0;">

  <form class="form" method="post" action="/api/calendar">
    <input type="hidden" name="action" value="add" />
    <label>날짜</label>
    <input type="date" name="date" value="{{ date }}" required />
    <label>메모</label>
    <textarea name="memo" rows="3" placeholder="메모 입력" required></textarea>
    <div class="row2">
      <div><label>작성자</label><input name="author" placeholder="이름(선택)" /></div>
      <div style="display:flex;align-items:end;"><button type="submit">메모 추가</button></div>
    </div>
    <div class="small">DB 저장(여러 명 동시 확인 가능)</div>
  </form>

  <hr style="border:none;border-top:1px solid #e6e9ee;margin:14px 0;">

  <h3 style="margin:0 0 10px;">메모 목록</h3>
  {% for r in rows %}
    <div class="card" style="margin:10px 0;">
      <div class="small">{{ r['date'] }} · {{ r['author'] }} · {{ r['updated_at'] }}</div>
      <div style="margin-top:6px;white-space:pre-wrap;">{{ r['memo'] }}</div>
      <div class="actions" style="margin-top:10px;">
        <form method="post" action="/api/calendar" style="flex:1;">
          <input type="hidden" name="action" value="update" />
          <input type="hidden" name="id" value="{{ r['id'] }}" />
          <input type="hidden" name="date" value="{{ r['date'] }}" />
          <input type="text" name="author" placeholder="작성자" value="{{ r['author'] }}" />
          <textarea name="memo" rows="2">{{ r['memo'] }}</textarea>
          <button type="submit">수정</button>
        </form>
        <form method="post" action="/api/calendar" style="width:120px;">
          <input type="hidden" name="action" value="delete" />
          <input type="hidden" name="id" value="{{ r['id'] }}" />
          <input type="hidden" name="date" value="{{ r['date'] }}" />
          <button type="submit" style="background:#ef4444;">삭제</button>
        </form>
      </div>
    </div>
  {% endfor %}
</div>
{% endblock %}
